{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useAddCartItemMutation, useChangeCartItemMutation, useLazyGetCartQuery } from '../redux/injected/injectedCart';\nimport { useErrorHandler } from './useErrorHandler';\nexport const useAddProduct = () => {\n  _s();\n  const [getCartItems, {\n    data,\n    isError,\n    error\n  }] = useLazyGetCartQuery();\n  useErrorHandler({\n    ...addErrorHandlerData\n  });\n  const [addCartItem, addStatues] = useAddCartItemMutation();\n  const addErrorHandlerData = {\n    error: addStatues.error,\n    isError: addStatues.isError,\n    isClient: true,\n    errorMessage: 'Произошла ошибка при попытке добавления товара в корзину'\n  };\n  useErrorHandler({\n    ...addErrorHandlerData\n  });\n  const [changeCartItem, changeStatuses] = useChangeCartItemMutation();\n  const changeErrorHandlerData = {\n    error: changeStatuses.error,\n    isError: changeStatuses.isError,\n    isClient: true,\n    errorMessage: 'Произошла ошибка при попытке увеличения колличества товара'\n  };\n  useErrorHandler({\n    ...changeErrorHandlerData\n  });\n  const addProduct = async item => {\n    await getCartItems();\n    if (data) {\n      console.log('lll');\n      if (data.find(obj => +obj.id === item.id)) {\n        const existingCount = data.find(obj => +obj.id === item.id);\n        item.count += existingCount.count;\n        item.id = +existingCount.id;\n        await changeCartItem(item);\n      } else {\n        await addCartItem(item);\n      }\n    }\n  };\n  return addProduct;\n};\n_s(useAddProduct, \"fQpbAZVgj9XEyeLCuU+0CRsXBAk=\", false, function () {\n  return [useLazyGetCartQuery, useErrorHandler, useAddCartItemMutation, useErrorHandler, useChangeCartItemMutation, useErrorHandler];\n});","map":{"version":3,"names":["useAddCartItemMutation","useChangeCartItemMutation","useLazyGetCartQuery","useErrorHandler","useAddProduct","getCartItems","data","isError","error","addErrorHandlerData","addCartItem","addStatues","isClient","errorMessage","changeCartItem","changeStatuses","changeErrorHandlerData","addProduct","item","console","log","find","obj","id","existingCount","count"],"sources":["C:/Users/Marginal1/Desktop/react-stroyka/client/src/hooks/useAddProduct.ts"],"sourcesContent":["import { useSelector } from 'react-redux';\r\nimport { TransmittedData } from '../@types/models';\r\nimport { useGetCartQuery, useAddCartItemMutation, useChangeCartItemMutation, useLazyGetCartQuery } from '../redux/injected/injectedCart';\r\n\r\nimport { RootState, useAppDispatch } from '../redux/store';\r\nimport { useErrorHandler } from './useErrorHandler';\r\n\r\nexport const useAddProduct = () => {\r\n\r\n    \r\n\r\n    const [getCartItems, { data, isError, error }] = useLazyGetCartQuery();\r\n\r\n    useErrorHandler({ ...addErrorHandlerData })\r\n\r\n    const [addCartItem, addStatues] = useAddCartItemMutation();\r\n\r\n    const addErrorHandlerData = {\r\n        error: addStatues.error,\r\n        isError: addStatues.isError,\r\n        isClient: true,\r\n        errorMessage: 'Произошла ошибка при попытке добавления товара в корзину',\r\n    }\r\n\r\n    useErrorHandler({ ...addErrorHandlerData })\r\n\r\n    const [changeCartItem, changeStatuses] = useChangeCartItemMutation();\r\n\r\n    const changeErrorHandlerData = {\r\n        error: changeStatuses.error,\r\n        isError: changeStatuses.isError,\r\n        isClient: true,\r\n        errorMessage: 'Произошла ошибка при попытке увеличения колличества товара',\r\n    }\r\n\r\n    useErrorHandler({ ...changeErrorHandlerData })\r\n\r\n    const addProduct = async (item: TransmittedData) => {\r\n\r\n        await getCartItems()\r\n\r\n        if (data) {\r\n            console.log('lll')\r\n            if (data.find((obj) => +obj.id === item.id)) {\r\n                const existingCount = data.find((obj) => +obj.id === item.id)\r\n                item.count += existingCount!.count\r\n                item.id = +existingCount!.id\r\n                await changeCartItem(item)\r\n            } else {\r\n                await addCartItem(item)\r\n            }\r\n        }\r\n    }\r\n\r\n    return addProduct\r\n}"],"mappings":";AAEA,SAA0BA,sBAAsB,EAAEC,yBAAyB,EAAEC,mBAAmB,QAAQ,gCAAgC;AAGxI,SAASC,eAAe,QAAQ,mBAAmB;AAEnD,OAAO,MAAMC,aAAa,GAAG,MAAM;EAAA;EAI/B,MAAM,CAACC,YAAY,EAAE;IAAEC,IAAI;IAAEC,OAAO;IAAEC;EAAM,CAAC,CAAC,GAAGN,mBAAmB,EAAE;EAEtEC,eAAe,CAAC;IAAE,GAAGM;EAAoB,CAAC,CAAC;EAE3C,MAAM,CAACC,WAAW,EAAEC,UAAU,CAAC,GAAGX,sBAAsB,EAAE;EAE1D,MAAMS,mBAAmB,GAAG;IACxBD,KAAK,EAAEG,UAAU,CAACH,KAAK;IACvBD,OAAO,EAAEI,UAAU,CAACJ,OAAO;IAC3BK,QAAQ,EAAE,IAAI;IACdC,YAAY,EAAE;EAClB,CAAC;EAEDV,eAAe,CAAC;IAAE,GAAGM;EAAoB,CAAC,CAAC;EAE3C,MAAM,CAACK,cAAc,EAAEC,cAAc,CAAC,GAAGd,yBAAyB,EAAE;EAEpE,MAAMe,sBAAsB,GAAG;IAC3BR,KAAK,EAAEO,cAAc,CAACP,KAAK;IAC3BD,OAAO,EAAEQ,cAAc,CAACR,OAAO;IAC/BK,QAAQ,EAAE,IAAI;IACdC,YAAY,EAAE;EAClB,CAAC;EAEDV,eAAe,CAAC;IAAE,GAAGa;EAAuB,CAAC,CAAC;EAE9C,MAAMC,UAAU,GAAG,MAAOC,IAAqB,IAAK;IAEhD,MAAMb,YAAY,EAAE;IAEpB,IAAIC,IAAI,EAAE;MACNa,OAAO,CAACC,GAAG,CAAC,KAAK,CAAC;MAClB,IAAId,IAAI,CAACe,IAAI,CAAEC,GAAG,IAAK,CAACA,GAAG,CAACC,EAAE,KAAKL,IAAI,CAACK,EAAE,CAAC,EAAE;QACzC,MAAMC,aAAa,GAAGlB,IAAI,CAACe,IAAI,CAAEC,GAAG,IAAK,CAACA,GAAG,CAACC,EAAE,KAAKL,IAAI,CAACK,EAAE,CAAC;QAC7DL,IAAI,CAACO,KAAK,IAAID,aAAa,CAAEC,KAAK;QAClCP,IAAI,CAACK,EAAE,GAAG,CAACC,aAAa,CAAED,EAAE;QAC5B,MAAMT,cAAc,CAACI,IAAI,CAAC;MAC9B,CAAC,MAAM;QACH,MAAMR,WAAW,CAACQ,IAAI,CAAC;MAC3B;IACJ;EACJ,CAAC;EAED,OAAOD,UAAU;AACrB,CAAC;AAAA,GAhDYb,aAAa;EAAA,QAI2BF,mBAAmB,EAEpEC,eAAe,EAEmBH,sBAAsB,EASxDG,eAAe,EAE0BF,yBAAyB,EASlEE,eAAe;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}