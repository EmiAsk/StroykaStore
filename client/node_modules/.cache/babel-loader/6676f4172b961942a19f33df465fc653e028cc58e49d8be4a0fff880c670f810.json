{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nexport const useSearch = _ref => {\n  _s();\n  let {\n    isFocused,\n    debounced,\n    searchValue,\n    setSearchValue,\n    setDropdown,\n    formRef\n  } = _ref;\n  const navigate = useNavigate();\n  const {\n    pathname\n  } = useLocation();\n  useEffect(() => {\n    setDropdown(false);\n  }, [pathname]);\n  const history = localStorage.getItem('hist');\n  const workWithHistory = () => {\n    if (history !== null && JSON.parse(history).length < 10) {\n      localStorage.setItem('hist', JSON.stringify(Array.from(new Set([searchValue, ...JSON.parse(history)]))));\n    } else if (history === null || !Array.isArray(JSON.parse(history))) {\n      localStorage.setItem('hist', JSON.stringify([searchValue]));\n    } else {\n      localStorage.setItem('hist', JSON.stringify(Array.from(new Set([searchValue, ...JSON.parse(history).splice(0, 9)]))));\n    }\n  };\n  const redirect = e => {\n    if (isFocused === true && e.key === 'Enter') {\n      e.preventDefault();\n      navigate(`/catalog/search?q=${debounced}`);\n      setSearchValue('');\n      setDropdown(false);\n      workWithHistory();\n      if (formRef.current !== null) {\n        const input = formRef.current.children[0];\n        input.blur();\n      }\n    }\n  };\n  const onClickSearchBtn = () => {\n    navigate(`/catalog/search?q=${debounced}`);\n    setSearchValue('');\n    workWithHistory();\n    if (formRef.current !== null) {\n      const input = formRef.current.children[0];\n      input.blur();\n    }\n    setDropdown(false);\n  };\n  const onClickHistoryItem = str => {\n    setSearchValue(str);\n    if (formRef.current !== null) {\n      const input = formRef.current.children[0];\n      input.focus();\n    }\n  };\n  return {\n    redirect,\n    onClickSearchBtn,\n    onClickHistoryItem\n  };\n};\n_s(useSearch, \"g7hds0uA6YFx0yLNsR3dzUIJAGY=\", false, function () {\n  return [useNavigate, useLocation];\n});","map":{"version":3,"names":["useEffect","useLocation","useNavigate","useSearch","isFocused","debounced","searchValue","setSearchValue","setDropdown","formRef","navigate","pathname","history","localStorage","getItem","workWithHistory","JSON","parse","length","setItem","stringify","Array","from","Set","isArray","splice","redirect","e","key","preventDefault","current","input","children","blur","onClickSearchBtn","onClickHistoryItem","str","focus"],"sources":["C:/Users/Marginal1/Desktop/react-stroyka/client/src/hooks/useSearch.ts"],"sourcesContent":["import { useEffect, RefObject, KeyboardEvent } from \"react\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\n\r\ntype TUseSearch = {\r\n    isFocused: boolean;\r\n    debounced: string;\r\n    searchValue: string;\r\n    setSearchValue: (x: string) => void;\r\n    setDropdown: (x: boolean) => void;\r\n    formRef: RefObject<HTMLFormElement>;\r\n}\r\n\r\nexport const useSearch = ({ isFocused, debounced, searchValue, setSearchValue, setDropdown, formRef }: TUseSearch) => {\r\n\r\n    const navigate = useNavigate();\r\n\r\n    const { pathname } = useLocation();\r\n\r\n    useEffect(() => {\r\n        setDropdown(false)\r\n    }, [pathname]);\r\n\r\n    const history = localStorage.getItem('hist');\r\n\r\n    const workWithHistory = () => {\r\n        if (history !== null && JSON.parse(history).length < 10) {\r\n            localStorage.setItem('hist', JSON.stringify(Array.from(new Set([searchValue, ...JSON.parse(history)]))))\r\n        } else if (history === null || !Array.isArray(JSON.parse(history))) {\r\n            localStorage.setItem('hist', JSON.stringify([searchValue]))\r\n        } else {\r\n            localStorage.setItem('hist', JSON.stringify(Array.from(new Set([searchValue, ...JSON.parse(history).splice(0, 9)]))))\r\n        }\r\n    }\r\n\r\n    const redirect = (e: KeyboardEvent<HTMLInputElement>) => {\r\n        if (isFocused === true && e.key === 'Enter') {\r\n            e.preventDefault()\r\n            navigate(`/catalog/search?q=${debounced}`)\r\n            setSearchValue('')\r\n            setDropdown(false)\r\n            workWithHistory()\r\n            if (formRef.current !== null) {\r\n                const input = formRef.current.children[0] as HTMLInputElement\r\n                input.blur()\r\n            }\r\n        }\r\n    }\r\n\r\n    const onClickSearchBtn = () => {\r\n        navigate(`/catalog/search?q=${debounced}`)\r\n        setSearchValue('')\r\n        workWithHistory()\r\n        if (formRef.current !== null) {\r\n            const input = formRef.current.children[0] as HTMLInputElement\r\n            input.blur()\r\n        }\r\n        setDropdown(false)\r\n    }\r\n\r\n    const onClickHistoryItem = (str: string) => {\r\n        setSearchValue(str)\r\n        if (formRef.current !== null) {\r\n            const input = formRef.current.children[0] as HTMLInputElement\r\n            input.focus()\r\n        }\r\n    }\r\n\r\n    return { redirect, onClickSearchBtn, onClickHistoryItem }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}